# AI 旅行规划助手 PRD（产品需求文档）

## 1. 文档信息
- **版本**：v1.0
- **更新日期**：2025-10-29
- **撰写人**：项目组
- **适用范围**：AI Travel Planner 课程作业项目，指导前后端研发、测试与验收

## 2. 背景与目标
现代旅行者需要在有限时间内完成目的地调研、行程安排、预算控制和实时调整，传统手工规划耗时且难以兼顾个性化需求。本项目旨在利用大语言模型与多模态 API，提供“会听懂、有建议、能执行”的智能旅行助手，覆盖“计划-执行-复盘”全流程。

**项目目标：**
1. 帮助用户快速生成符合偏好与预算的旅行行程，并随时可查。
2. 提供语音驱动的交互入口，实现无障碍的计划与记账体验。
3. 构建跨端可同步的云端旅行资料库，方便管理多份计划与开销。

## 3. 用户画像
| 用户类型        | 典型场景                         | 核心诉求                             |
| --------------- | -------------------------------- | ------------------------------------ |
| 学生/年轻职场人 | 想在假期内高效安排行程，预算有限 | 快速获得高性价比行程、实时掌控预算   |
| 家庭用户        | 家庭旅行，口味和偏好差异较大     | 语音输入更自然，行程要兼顾多群体需求 |
| 商务出行者      | 突发行程，需要临时规划并记录费用 | 生成行程框架、方便导出费用记录       |

## 4. 产品愿景
> “用一次对话搞定旅行，从灵感到执行，AI 都能给出靠谱建议并持续陪伴。”

- **智能**：理解口语化需求，生成可执行的路线、预算方案与提醒。
- **可信**：基于 Supabase 等云服务保持数据一致、安全、可追溯。
- **可扩展**：开放式架构，后续能引入路线分享、多人协同等高级功能。

## 5. 核心功能
1. **智能行程规划**
   - 语音/文字输入目的地、时间、预算、偏好、同行人等信息。
   - 调用大模型（千问 Qwen 或字节豆包）生成天级行程、交通、餐饮、住宿建议。
   - 提供地图位置、推荐理由、预计花费，并支持导出/分享。

2. **费用预算与管理**
   - AI 估算总体与分日预算，标记潜在超支环节。
   - 语音或表单录入实际开销，按类别（餐饮/交通等）统计。
   - 实时展示预算 vs 实际差异，支持趋势图、类别环形图。

3. **用户账户与云端同步**
   - 注册/登录（基础要求：至少保留接口与数据结构）。
   - Supabase 持久化保存行程、偏好、费用数据，支持多端访问。
   - 未来可扩展多计划管理、收藏夹等。

4. **地图导航与路线规划**
   - 调用高德地图 API 进行 POI 搜索。
   - 支持交通方式（步行/公交/驾车）路线规划、距离与时长估算。

5. **语音交互**
   - 集成科大讯飞语音识别，支持中文实时转写。
   - 语音录入行程需求、开销信息，并可二次编辑确认。

## 6. 功能需求详情
### 6.1 旅程创建流程
1. 入口：主页 CTA / “开始规划”按钮 / 语音唤起。
2. 输入信息：
   - 目的地（必填）
   - 出发/结束日期（必填）
   - 总预算、同行人数（必填）
   - 旅行偏好标签（多选：美食、文化、亲子、探险等）
   - 特殊需求文本（选填）
3. LLM 生成：
   - 每日 Morning/Afternoon/Evening 活动
   - 推荐交通/住宿/餐饮
   - 每日预估花费、总花费对比预算
4. 成果页：
   - 行程时间线 + 地图预览
   - 预算概览（计划、估算、剩余）
   - AI 导航建议、注意事项
   - 支持保存、分享链接、复制到新计划

### 6.2 费用记录流程
1. 入口：行程详情页快捷按钮或“费用中心”页面。
2. 语音或手动录入：类别、金额、描述、时间、地点。
3. 保存后触发预算刷新，展示剩余预算、占比图。
4. 历史记录可按日期/类别筛选，支持编辑/删除。

### 6.3 语音交互流程
1. 点击麦克风按钮或快捷语音指令。
2. 显示录音进度与取消、完成选项。
3. 将识别文本回显给用户，可编辑后提交。
4. 根据上下文决定调用行程生成或费用记录接口。

### 6.4 用户与同步
- 用户登录成功后，可查看历史计划列表。
- 操作数据实时写入 Supabase，对应字段：
  - `itineraries`：行程主数据、daily_itinerary JSON。
  - `expenses`：费用明细，关联行程 ID。
- 支持从任意设备访问同一账号的数据（最少后端实现，前端可展示模拟）。

## 7. 系统流程概览
```
语音/文字输入 → 前端处理 → 后端 FastAPI → 
  ① 调用 LLM 服务生成行程
  ② 调用高德 API 获取地理信息
  ③ 调用讯飞 API 进行语音转写
结果写入 Supabase → 前端展示行程/预算 → 用户继续操作
```

## 8. 非功能需求
- **性能**：行程生成接口响应 < 8 秒（依赖 LLM）；查询类接口 < 1 秒。
- **可用性**：前端需兼容桌面与移动端；语音录入必须提供重试与取消。
- **安全性**：环境变量管理外部 API key；JWT 用于后端鉴权（课程作业可保留占位实现）。
- **可维护性**：前后端代码按模块拆分，提供中文注释与文档。

## 9. 集成与依赖
| 模块        | 服务                                  | 说明                             |
| ----------- | ------------------------------------- | -------------------------------- |
| LLM 服务    | 阿里云百炼（千问）/字节火山豆包       | 生成行程与建议                   |
| 语音识别    | 科大讯飞开放平台                      | 语音转文字，需实名认证与应用配置 |
| 地图导航    | 高德地图开放平台                      | POI 搜索与路线规划               |
| 数据库/认证 | Supabase                              | PostgreSQL + 简易 Auth           |
| 前端        | Vue3 + Vite + Pinia + Axios           | UI 交互与状态管理                |
| 后端        | FastAPI + Supabase Python SDK + HTTPX | RESTful 服务层                   |

## 10. 成功指标（KPI）
- 行程生成成功率 ≥ 90%（无致命错误返回）。
- 语音识别准确率 ≥ 85%（以可编辑文本为准）。
- 预算对比界面加载时间 ≤ 1 秒。
- 用户可保存 ≥ 3 份不同行程并切换查看。

## 11. 迭代计划
1. **MVP（课程验收）**：行程生成、费用记录、语音输入、地图查询、云端存储。
2. **第二阶段（可选）**：用户登录 UI、预算超支提醒、行程导出 PDF。
3. **展望（非必需）**：多人协作、社交分享、离线缓存、AR 导览。

## 12. 风险与对策
| 风险                    | 影响                | 缓解策略                                       |
| ----------------------- | ------------------- | ---------------------------------------------- |
| 外部 API 限额或访问失败 | 行程/语音功能不可用 | 提供降级方案（使用示例数据或提示用户稍后重试） |
| LLM 输出不稳定          | 行程质量下降        | 增加 Prompt 模板与后端数据校验逻辑             |
| 语音识别延迟            | 用户体验差          | 前端提供加载提示并允许文字补充                 |
| 数据敏感信息泄露        | 安全合规问题        | 仅在本地 `.env` 保存密钥，仓库使用示例值       |

---
本 PRD 为团队实现与测试提供基线。若需求调整，请在版本记录中更新并同步到相关文档与实现。